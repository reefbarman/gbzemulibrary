using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;

namespace GBZEmuLibrary
{
    internal class InstructionSchema
    {
        public const int TWENTY_FOUR_CYCLES = 24;
        public const int TWENTY_CYCLES      = 20;
        public const int SIXTEEN_CYCLES     = 16;
        public const int TWELVE_CYCLES      = 12;
        public const int EIGHT_CYCLES       = 8;
        public const int FOUR_CYCLES        = 4;

        public const int FLAG_Z = 7;
        public const int FLAG_N = 6;
        public const int FLAG_H = 5;
        public const int FLAG_C = 4;
    }

    internal class InstructionSet
    {
        public const byte NOP      = 0;
        public const byte LDBCnn   = 0x01;
        public const byte LDBCA    = 0x02;
        public const byte INCBC    = 0x03;
        public const byte INCB     = 0x04;
        public const byte DECB     = 0x05;
        public const byte LDBn     = 0x06;
        public const byte RLCA     = 0x07;
        public const byte LDnnSP   = 0x08;
        public const byte ADDHLBC  = 0x09;
        public const byte LDABC    = 0x0A;
        public const byte DECBC    = 0x0B;
        public const byte INCC     = 0x0C;
        public const byte DECC     = 0x0D;
        public const byte LDCn     = 0x0E;
        public const byte RRCA     = 0x0F;
        public const byte STOP     = 0x10;
        public const byte LDDEnn   = 0x11;
        public const byte LDDEA    = 0x12;
        public const byte INCDE    = 0x13;
        public const byte INCD     = 0x14;
        public const byte DECD     = 0x15;
        public const byte LDDn     = 0x16;
        public const byte RLA      = 0x17;
        public const byte JRn      = 0x18;
        public const byte ADDHLDE  = 0x19;
        public const byte LDADE    = 0x1A;
        public const byte DECDE    = 0x1B;
        public const byte INCE     = 0x1C;
        public const byte DECE     = 0x1D;
        public const byte LDEn     = 0x1E;
        public const byte RRA      = 0x1F;
        public const byte JRNZn    = 0x20;
        public const byte LDHLnn   = 0x21;
        public const byte LDHLIA   = 0x22;
        public const byte INCHL    = 0x23;
        public const byte INCH     = 0x24;
        public const byte DECH     = 0x25;
        public const byte LDHn     = 0x26;
        public const byte DAA      = 0x27;
        public const byte JRZn     = 0x28;
        public const byte ADDHLHL  = 0x29;
        public const byte LDAHLI   = 0x2A;
        public const byte DECHL    = 0x2B;
        public const byte INCL     = 0x2C;
        public const byte DECL     = 0x2D;
        public const byte LDLn     = 0x2E;
        public const byte CPL      = 0x2F;
        public const byte JRNCn    = 0x30;
        public const byte LDSPnn   = 0x31;
        public const byte LDHLDA   = 0x32;
        public const byte INCSP    = 0x33;
        public const byte INCHLa   = 0x34;
        public const byte DECHLa   = 0x35;
        public const byte LDHLn    = 0x36;
        public const byte SCF      = 0x37;
        public const byte JRCn     = 0x38;
        public const byte ADDHLSP  = 0x39;
        public const byte LDAHLD   = 0x3A;
        public const byte DECSP    = 0x3B;
        public const byte INCA     = 0x3C;
        public const byte DECA     = 0x3D;
        public const byte LDAn     = 0x3E;
        public const byte CCF      = 0x3F;
        public const byte LDBB     = 0x40;
        public const byte LDBC     = 0x41;
        public const byte LDBD     = 0x42;
        public const byte LDBE     = 0x43;
        public const byte LDBH     = 0x44;
        public const byte LDBL     = 0x45;
        public const byte LDBHL    = 0x46;
        public const byte LDBA     = 0x47;
        public const byte LDCB     = 0x48;
        public const byte LDCC     = 0x49;
        public const byte LDCD     = 0x4A;
        public const byte LDCE     = 0x4B;
        public const byte LDCH     = 0x4C;
        public const byte LDCL     = 0x4D;
        public const byte LDCHL    = 0x4E;
        public const byte LDrCA    = 0x4F;
        public const byte LDDB     = 0x50;
        public const byte LDDC     = 0x51;
        public const byte LDDD     = 0x52;
        public const byte LDDE     = 0x53;
        public const byte LDDH     = 0x54;
        public const byte LDDL     = 0x55;
        public const byte LDDHL    = 0x56;
        public const byte LDDA     = 0x57;
        public const byte LDEB     = 0x58;
        public const byte LDEC     = 0x59;
        public const byte LDED     = 0x5A;
        public const byte LDEE     = 0x5B;
        public const byte LDEH     = 0x5C;
        public const byte LDEL     = 0x5D;
        public const byte LDEHL    = 0x5E;
        public const byte LDEA     = 0x5F;
        public const byte LDHB     = 0x60;
        public const byte LDHC     = 0x61;
        public const byte LDHD     = 0x62;
        public const byte LDHE     = 0x63;
        public const byte LDHH     = 0x64;
        public const byte LDHL     = 0x65;
        public const byte LDHHL    = 0x66;
        public const byte LDHA     = 0x67;
        public const byte LDLB     = 0x68;
        public const byte LDLC     = 0x69;
        public const byte LDLD     = 0x6A;
        public const byte LDLE     = 0x6B;
        public const byte LDLH     = 0x6C;
        public const byte LDLL     = 0x6D;
        public const byte LDLHL    = 0x6E;
        public const byte LDLA     = 0x6F;
        public const byte LDHLB    = 0x70;
        public const byte LDHLC    = 0x71;
        public const byte LDHLD    = 0x72;
        public const byte LDHLE    = 0x73;
        public const byte LDHLH    = 0x74;
        public const byte LDHLL    = 0x75;
        public const byte HALT     = 0x76;
        public const byte LDHLA    = 0x77;
        public const byte LDAB     = 0x78;
        public const byte LDrAC    = 0x79;
        public const byte LDAD     = 0x7A;
        public const byte LDAE     = 0x7B;
        public const byte LDAH     = 0x7C;
        public const byte LDAL     = 0x7D;
        public const byte LDAHL    = 0x7E;
        public const byte LDAA     = 0x7F;
        public const byte ADDB     = 0x80;
        public const byte ADDC     = 0x81;
        public const byte ADDD     = 0x82;
        public const byte ADDE     = 0x83;
        public const byte ADDH     = 0x84;
        public const byte ADDL     = 0x85;
        public const byte ADDHL    = 0x86;
        public const byte ADDA     = 0x87;
        public const byte ADCB     = 0x88;
        public const byte ADCC     = 0x89;
        public const byte ADCD     = 0x8A;
        public const byte ADCE     = 0x8B;
        public const byte ADCH     = 0x8C;
        public const byte ADCL     = 0x8D;
        public const byte ADCHL    = 0x8E;
        public const byte ADCA     = 0x8F;
        public const byte SUBB     = 0x90;
        public const byte SUBC     = 0x91;
        public const byte SUBD     = 0x92;
        public const byte SUBE     = 0x93;
        public const byte SUBH     = 0x94;
        public const byte SUBL     = 0x95;
        public const byte SUBHL    = 0x96;
        public const byte SUBA     = 0x97;
        public const byte SBCAB    = 0x98;
        public const byte SBCAC    = 0x99;
        public const byte SBCAD    = 0x9A;
        public const byte SBCAE    = 0x9B;
        public const byte SBCAH    = 0x9C;
        public const byte SBCAL    = 0x9D;
        public const byte SBCAHL   = 0x9E;
        public const byte SBCAA    = 0x9F;
        public const byte ANDB     = 0xA0;
        public const byte ANDC     = 0xA1;
        public const byte ANDD     = 0xA2;
        public const byte ANDE     = 0xA3;
        public const byte ANDH     = 0xA4;
        public const byte ANDL     = 0xA5;
        public const byte ANDHL    = 0xA6;
        public const byte ANDA     = 0xA7;
        public const byte XORB     = 0xA8;
        public const byte XORC     = 0xA9;
        public const byte XORD     = 0xAA;
        public const byte XORE     = 0xAB;
        public const byte XORH     = 0xAC;
        public const byte XORL     = 0xAD;
        public const byte XORHL    = 0xAE;
        public const byte XORA     = 0xAF;
        public const byte ORB      = 0xB0;
        public const byte ORC      = 0xB1;
        public const byte ORD      = 0xB2;
        public const byte ORE      = 0xB3;
        public const byte ORH      = 0xB4;
        public const byte ORL      = 0xB5;
        public const byte ORHL     = 0xB6;
        public const byte ORA      = 0xB7;
        public const byte CPB      = 0xB8;
        public const byte CPC      = 0xB9;
        public const byte CPD      = 0xBA;
        public const byte CPE      = 0xBB;
        public const byte CPH      = 0xBC;
        public const byte CPrL     = 0xBD;
        public const byte CPHL     = 0xBE;
        public const byte CPA      = 0xBF;
        public const byte RETNZ    = 0xC0;
        public const byte POPBC    = 0xC1;
        public const byte JPNZnn   = 0xC2;
        public const byte JPnn     = 0xC3;
        public const byte CALLNZnn = 0xC4;
        public const byte PUSHBC   = 0xC5;
        public const byte ADDn     = 0xC6;
        public const byte RST00H   = 0xC7;
        public const byte RETZ     = 0xC8;
        public const byte RET      = 0xC9;
        public const byte JPZnn    = 0xCA;
        public const byte PrefixCB = 0xCB;
        public const byte CALLZnn  = 0xCC;
        public const byte CALLnn   = 0xCD;
        public const byte ADCn     = 0xCE;
        public const byte RST08H   = 0xCF;
        public const byte RETNC    = 0xD0;
        public const byte POPDE    = 0xD1;
        public const byte JPNCnn   = 0xD2;
        public const byte CALLNCnn = 0xD4;
        public const byte PUSHDE   = 0xD5;
        public const byte SUBn     = 0xD6;
        public const byte RST10H   = 0xD7;
        public const byte RETC     = 0xD8;
        public const byte RETI     = 0xD9;
        public const byte JPCnn    = 0xDA;
        public const byte CALLCnn  = 0xDC;
        public const byte SBCAn    = 0xDE;
        public const byte RST18H   = 0xDF;
        public const byte LDHnA    = 0xE0;
        public const byte POPHL    = 0xE1;
        public const byte LDCA     = 0xE2;
        public const byte PUSHHL   = 0xE5;
        public const byte ANDn     = 0xE6;
        public const byte RST20H   = 0xE7;
        public const byte ADDSPn   = 0xE8;
        public const byte JPHL     = 0xE9;
        public const byte LDnnA    = 0xEA;
        public const byte XORn     = 0xEE;
        public const byte RST28H   = 0xEF;
        public const byte LDHAn    = 0xF0;
        public const byte POPAF    = 0xF1;
        public const byte LDAC     = 0xF2;
        public const byte DI       = 0xF3;
        public const byte PUSHAF   = 0xF5;
        public const byte ORn      = 0xF6;
        public const byte RST30H   = 0xF7;
        public const byte LDHLSPn  = 0xF8;
        public const byte LDSPHL   = 0xF9;
        public const byte LDAnn    = 0xFA;
        public const byte EI       = 0xFB;
        public const byte CPn      = 0xFE;
        public const byte RST38H   = 0xFF;

        public static string GetInstructionName(byte instruction)
        {
            return (from field in typeof(InstructionSet).GetFields(BindingFlags.Static | BindingFlags.Public) where field.FieldType == typeof(byte) && instruction == (byte)field.GetValue(null) select field.Name).FirstOrDefault();
        }
    }

    internal class CBInstructionSet
    {
        public const byte RLCB   = 0;
        public const byte RLCC   = 0x01;
        public const byte RLCD   = 0x02;
        public const byte RLCE   = 0x03;
        public const byte RLCH   = 0x04;
        public const byte RLCL   = 0x05;
        public const byte RLCHL  = 0x06;
        public const byte RLCA   = 0x07;
        public const byte RRCB   = 0x08;
        public const byte RRCC   = 0x09;
        public const byte RRCD   = 0x0A;
        public const byte RRCE   = 0x0B;
        public const byte RRCH   = 0x0C;
        public const byte RRCL   = 0x0D;
        public const byte RRCHL  = 0x0E;
        public const byte RRCA   = 0x0F;
        public const byte RLB    = 0x10;
        public const byte RLC    = 0x11;
        public const byte RLD    = 0x12;
        public const byte RLE    = 0x13;
        public const byte RLH    = 0x14;
        public const byte RLL    = 0x15;
        public const byte RLHL   = 0x16;
        public const byte RLA    = 0x17;
        public const byte RRB    = 0x18;
        public const byte RRC    = 0x19;
        public const byte RRD    = 0x1A;
        public const byte RRE    = 0x1B;
        public const byte RRH    = 0x1C;
        public const byte RRL    = 0x1D;
        public const byte RRHL   = 0x1E;
        public const byte RRA    = 0x1F;
        public const byte SLAB   = 0x20;
        public const byte SLAC   = 0x21;
        public const byte SLAD   = 0x22;
        public const byte SLAE   = 0x23;
        public const byte SLAH   = 0x24;
        public const byte SLAL   = 0x25;
        public const byte SLAHL  = 0x26;
        public const byte SLAA   = 0x27;
        public const byte SRAB   = 0x28;
        public const byte SRAC   = 0x29;
        public const byte SRAD   = 0x2A;
        public const byte SRAE   = 0x2B;
        public const byte SRAH   = 0x2C;
        public const byte SRAL   = 0x2D;
        public const byte SRAHL  = 0x2E;
        public const byte SRAA   = 0x2F;
        public const byte SWAPB  = 0x30;
        public const byte SWAPC  = 0x31;
        public const byte SWAPD  = 0x32;
        public const byte SWAPE  = 0x33;
        public const byte SWAPH  = 0x34;
        public const byte SWAPL  = 0x35;
        public const byte SWAPHL = 0x36;
        public const byte SWAPA  = 0x37;
        public const byte SRLB   = 0x38;
        public const byte SRLC   = 0x39;
        public const byte SRLD   = 0x3A;
        public const byte SRLE   = 0x3B;
        public const byte SRLH   = 0x3C;
        public const byte SRLL   = 0x3D;
        public const byte SRLHL  = 0x3E;
        public const byte SRLA   = 0x3F;
        public const byte BIT0B  = 0x40;
        public const byte BIT0C  = 0x41;
        public const byte BIT0D  = 0x42;
        public const byte BIT0E  = 0x43;
        public const byte BIT0H  = 0x44;
        public const byte BIT0L  = 0x45;
        public const byte BIT0HL = 0x46;
        public const byte BIT0A  = 0x47;
        public const byte BIT1B  = 0x48;
        public const byte BIT1C  = 0x49;
        public const byte BIT1D  = 0x4A;
        public const byte BIT1E  = 0x4B;
        public const byte BIT1H  = 0x4C;
        public const byte BIT1L  = 0x4D;
        public const byte BIT1HL = 0x4E;
        public const byte BIT1A  = 0x4F;
        public const byte BIT2B  = 0x50;
        public const byte BIT2C  = 0x51;
        public const byte BIT2D  = 0x52;
        public const byte BIT2E  = 0x53;
        public const byte BIT2H  = 0x54;
        public const byte BIT2L  = 0x55;
        public const byte BIT2HL = 0x56;
        public const byte BIT2A  = 0x57;
        public const byte BIT3B  = 0x58;
        public const byte BIT3C  = 0x59;
        public const byte BIT3D  = 0x5A;
        public const byte BIT3E  = 0x5B;
        public const byte BIT3H  = 0x5C;
        public const byte BIT3L  = 0x5D;
        public const byte BIT3HL = 0x5E;
        public const byte BIT3A  = 0x5F;
        public const byte BIT4B  = 0x60;
        public const byte BIT4C  = 0x61;
        public const byte BIT4D  = 0x62;
        public const byte BIT4E  = 0x63;
        public const byte BIT4H  = 0x64;
        public const byte BIT4L  = 0x65;
        public const byte BIT4HL = 0x66;
        public const byte BIT4A  = 0x67;
        public const byte BIT5B  = 0x68;
        public const byte BIT5C  = 0x69;
        public const byte BIT5D  = 0x6A;
        public const byte BIT5E  = 0x6B;
        public const byte BIT5H  = 0x6C;
        public const byte BIT5L  = 0x6D;
        public const byte BIT5HL = 0x6E;
        public const byte BIT5A  = 0x6F;
        public const byte BIT6B  = 0x70;
        public const byte BIT6C  = 0x71;
        public const byte BIT6D  = 0x72;
        public const byte BIT6E  = 0x73;
        public const byte BIT6H  = 0x74;
        public const byte BIT6L  = 0x75;
        public const byte BIT6HL = 0x76;
        public const byte BIT6A  = 0x77;
        public const byte BIT7B  = 0x78;
        public const byte BIT7C  = 0x79;
        public const byte BIT7D  = 0x7A;
        public const byte BIT7E  = 0x7B;
        public const byte BIT7H  = 0x7C;
        public const byte BIT7L  = 0x7D;
        public const byte BIT7HL = 0x7E;
        public const byte BIT7A  = 0x7F;
        public const byte RES0B  = 0x80;
        public const byte RES0C  = 0x81;
        public const byte RES0D  = 0x82;
        public const byte RES0E  = 0x83;
        public const byte RES0H  = 0x84;
        public const byte RES0L  = 0x85;
        public const byte RES0HL = 0x86;
        public const byte RES0A  = 0x87;
        public const byte RES1B  = 0x88;
        public const byte RES1C  = 0x89;
        public const byte RES1D  = 0x8A;
        public const byte RES1E  = 0x8B;
        public const byte RES1H  = 0x8C;
        public const byte RES1L  = 0x8D;
        public const byte RES1HL = 0x8E;
        public const byte RES1A  = 0x8F;
        public const byte RES2B  = 0x90;
        public const byte RES2C  = 0x91;
        public const byte RES2D  = 0x92;
        public const byte RES2E  = 0x93;
        public const byte RES2H  = 0x94;
        public const byte RES2L  = 0x95;
        public const byte RES2HL = 0x96;
        public const byte RES2A  = 0x97;
        public const byte RES3B  = 0x98;
        public const byte RES3C  = 0x99;
        public const byte RES3D  = 0x9A;
        public const byte RES3E  = 0x9B;
        public const byte RES3H  = 0x9C;
        public const byte RES3L  = 0x9D;
        public const byte RES3HL = 0x9E;
        public const byte RES3A  = 0x9F;
        public const byte RES4B  = 0xA0;
        public const byte RES4C  = 0xA1;
        public const byte RES4D  = 0xA2;
        public const byte RES4E  = 0xA3;
        public const byte RES4H  = 0xA4;
        public const byte RES4L  = 0xA5;
        public const byte RES4HL = 0xA6;
        public const byte RES4A  = 0xA7;
        public const byte RES5B  = 0xA8;
        public const byte RES5C  = 0xA9;
        public const byte RES5D  = 0xAA;
        public const byte RES5E  = 0xAB;
        public const byte RES5H  = 0xAC;
        public const byte RES5L  = 0xAD;
        public const byte RES5HL = 0xAE;
        public const byte RES5A  = 0xAF;
        public const byte RES6B  = 0xB0;
        public const byte RES6C  = 0xB1;
        public const byte RES6D  = 0xB2;
        public const byte RES6E  = 0xB3;
        public const byte RES6H  = 0xB4;
        public const byte RES6L  = 0xB5;
        public const byte RES6HL = 0xB6;
        public const byte RES6A  = 0xB7;
        public const byte RES7B  = 0xB8;
        public const byte RES7C  = 0xB9;
        public const byte RES7D  = 0xBA;
        public const byte RES7E  = 0xBB;
        public const byte RES7H  = 0xBC;
        public const byte RES7L  = 0xBD;
        public const byte RES7HL = 0xBE;
        public const byte RES7A  = 0xBF;
        public const byte SET0B  = 0xC0;
        public const byte SET0C  = 0xC1;
        public const byte SET0D  = 0xC2;
        public const byte SET0E  = 0xC3;
        public const byte SET0H  = 0xC4;
        public const byte SET0L  = 0xC5;
        public const byte SET0HL = 0xC6;
        public const byte SET0A  = 0xC7;
        public const byte SET1B  = 0xC8;
        public const byte SET1C  = 0xC9;
        public const byte SET1D  = 0xCA;
        public const byte SET1E  = 0xCB;
        public const byte SET1H  = 0xCC;
        public const byte SET1L  = 0xCD;
        public const byte SET1HL = 0xCE;
        public const byte SET1A  = 0xCF;
        public const byte SET2B  = 0xD0;
        public const byte SET2C  = 0xD1;
        public const byte SET2D  = 0xD2;
        public const byte SET2E  = 0xD3;
        public const byte SET2H  = 0xD4;
        public const byte SET2L  = 0xD5;
        public const byte SET2HL = 0xD6;
        public const byte SET2A  = 0xD7;
        public const byte SET3B  = 0xD8;
        public const byte SET3C  = 0xD9;
        public const byte SET3D  = 0xDA;
        public const byte SET3E  = 0xDB;
        public const byte SET3H  = 0xDC;
        public const byte SET3L  = 0xDD;
        public const byte SET3HL = 0xDE;
        public const byte SET3A  = 0xDF;
        public const byte SET4B  = 0xE0;
        public const byte SET4C  = 0xE1;
        public const byte SET4D  = 0xE2;
        public const byte SET4E  = 0xE3;
        public const byte SET4H  = 0xE4;
        public const byte SET4L  = 0xE5;
        public const byte SET4HL = 0xE6;
        public const byte SET4A  = 0xE7;
        public const byte SET5B  = 0xE8;
        public const byte SET5C  = 0xE9;
        public const byte SET5D  = 0xEA;
        public const byte SET5E  = 0xEB;
        public const byte SET5H  = 0xEC;
        public const byte SET5L  = 0xED;
        public const byte SET5HL = 0xEE;
        public const byte SET5A  = 0xEF;
        public const byte SET6B  = 0xF0;
        public const byte SET6C  = 0xF1;
        public const byte SET6D  = 0xF2;
        public const byte SET6E  = 0xF3;
        public const byte SET6H  = 0xF4;
        public const byte SET6L  = 0xF5;
        public const byte SET6HL = 0xF6;
        public const byte SET6A  = 0xF7;
        public const byte SET7B  = 0xF8;
        public const byte SET7C  = 0xF9;
        public const byte SET7D  = 0xFA;
        public const byte SET7E  = 0xFB;
        public const byte SET7H  = 0xFC;
        public const byte SET7L  = 0xFD;
        public const byte SET7HL = 0xFE;
        public const byte SET7A  = 0xFF;
    }
}
